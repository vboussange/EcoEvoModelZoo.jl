<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · EcoEvoModelZoo.jl</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://vboussange.github.io/EcoEvoModelZoo.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>EcoEvoModelZoo.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/main/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="EcoEvoModelZoo"><a class="docs-heading-anchor" href="#EcoEvoModelZoo">EcoEvoModelZoo</a><a id="EcoEvoModelZoo-1"></a><a class="docs-heading-anchor-permalink" href="#EcoEvoModelZoo" title="Permalink"></a></h1><ul><li><a href="#EcoEvoModelZoo.AkessonModel"><code>EcoEvoModelZoo.AkessonModel</code></a></li><li><a href="#EcoEvoModelZoo.EcoEvoGraph"><code>EcoEvoModelZoo.EcoEvoGraph</code></a></li><li><a href="#EcoEvoModelZoo.EcosystemModelMcCann"><code>EcoEvoModelZoo.EcosystemModelMcCann</code></a></li><li><a href="#EcoEvoModelZoo.EcosystemModelOmnivory"><code>EcoEvoModelZoo.EcosystemModelOmnivory</code></a></li><li><a href="#EcoEvoModelZoo.Landscape"><code>EcoEvoModelZoo.Landscape</code></a></li><li><a href="#EcoEvoModelZoo.ResourceCompetition"><code>EcoEvoModelZoo.ResourceCompetition</code></a></li><li><a href="#EcoEvoModelZoo.ResourceCompetitionSmoothMin"><code>EcoEvoModelZoo.ResourceCompetitionSmoothMin</code></a></li><li><a href="#EcoEvoModelZoo.SimpleEcosystemModel"><code>EcoEvoModelZoo.SimpleEcosystemModel</code></a></li><li><a href="#EcoEvoModelZoo.Temperature"><code>EcoEvoModelZoo.Temperature</code></a></li><li><a href="#EcoEvoModelZoo.funcresp!-Tuple{Any, Any, Any, Trophic{true}}"><code>EcoEvoModelZoo.funcresp!</code></a></li><li><a href="#EcoEvoModelZoo.generate_network-Tuple{Int64, Int64}"><code>EcoEvoModelZoo.generate_network</code></a></li><li><a href="#EcoEvoModelZoo.init_akesson_model-Union{Tuple{}, Tuple{Tr}} where Tr"><code>EcoEvoModelZoo.init_akesson_model</code></a></li><li><a href="#EcoEvoModelZoo.smoothstep-Tuple{Any}"><code>EcoEvoModelZoo.smoothstep</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.AkessonModel" href="#EcoEvoModelZoo.AkessonModel"><code>EcoEvoModelZoo.AkessonModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>This model is inspired from <a href="https://www.nature.com/articles/s41467-021-24977-x">Akesson et al. 2021</a>.</p><p>Specialized variants are provided in other <code>AbstractModel</code>s. Best constructure with <code>init_akesson_model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/model.jl#L5-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.EcoEvoGraph" href="#EcoEvoModelZoo.EcoEvoGraph"><code>EcoEvoModelZoo.EcoEvoGraph</code></a> — <span class="docstring-category">Type</span></header><section><div><p>This model is inspired from <a href="https://www.nature.com/articles/s42003-022-03595-3">Boussange &amp; Pellissier. 2022</a></p><p><strong>Arguments</strong></p><ul><li><code>mp</code>: the model parameters</li><li><code>g</code>: the spatial graph</li><li><code>phen_space</code>: the discretized phenotypic space</li><li><code>birth_fn</code>: the birth function. Should be of the form <code>birth_fn(x, s, p)</code></li><li><code>competition_fn</code>: the competition function. Should be of the form <code>competition_fn(u_xs2, x, s1, s2, p)</code></li></ul><p><strong>Mathematical model</strong></p><p><code>∂ₜuˣ(s) = uˣ(s)[birth_fn(x, s, p) - uˣ(s)∫competition_fn(uˣ(s₂), x, s, s₂, p) ds₂] + 1/2 μ σ² Δₛuˣ(s) + m L u(s)</code></p><p>where <code>L</code> is the Laplacian matrix of the spatial graph <code>g</code>.</p><p><strong>Example 1</strong></p><pre><code class="language-julia hljs">using ParametricModels
using UnPack
using DocStringExtensions
using Statistics
using ComponentArrays
using Distributions
using OrdinaryDiffEq
using UnPack
## Defining phenotypic space and spatial graph
M = 7
g = star_graph(M)

rS = 1f0
dS = 0.02f0
phen_space = collect(range(-rS,rS,step=dS)) #grid

##
# Defining birth and competition functions
soptim = 0.5f0 * [-1,1,-1,1,-1,1,-1]
birth_fn(x, s, p) = max(0f0, 1f0 - (soptim[x] - s)^2)
competition_fn(u_xs2, x, s1, s2, p) = u_xs2 ./ p.K

## Defining parameters
σ_mu = 5f-2;
mu = 0.1f0
m = 0.1
K = 1.

p = ComponentArray(σ_mu = σ_mu,
                    mu = mu,
                    m = m,
                    K = K)


## rest of the simulation
tend = 1000f0
tspan = (0f0,tend)
tsteps = (tspan[1]):1.:(tspan[end])
u0 = vcat([K .* pdf.(Normal(so,σ_mu),phen_space&#39;) for so in soptim]...)

mp = ModelParams(;p,
                tspan,
                u0,
                alg=Tsit5(),
                saveat = tsteps)

model = EcoEvoGraph(mp, g, phen_space, birth_fn, competition_fn)

@time sol = simulate(model)

# Plotting results!
using PythonCall; plt = pyimport(&quot;matplotlib.pyplot&quot;)
fig, ax = plt.subplots(1)
ax.plot(model.phen_space, sol[end][1,:], color = &quot;tab:red&quot;, label = &quot;Node 1&quot;)
ax.plot(model.phen_space, sol[end][2,:], color = &quot;tab:blue&quot;, label = &quot;Node 2&quot;)
ax.set_xlabel(&quot;Phenotype&quot;)
ax.set_ylabel(&quot;Population number&quot;)
display(fig)</code></pre><p><strong>Example 2: trait dependent competition</strong></p><pre><code class="language-julia hljs"># Trait dependent compeition
rS = 3f0
dS = 0.02f0
phen_space = collect(range(-rS,rS,step=dS)) #grid

p = ComponentArray(σ_mu = σ_mu,
                    mu = mu,
                    m = m,
                    K = K,
                    σ_α = 0.5)
# trait dependent competition
competition_fn(u_xs2, x, s1, s2, p) = u_xs2 * exp(- 0.5f0 * (s1 - s2)^2 ./ p.σ_α^2) ./ p.K

u0 = vcat([K .* pdf.(Normal(so,σ_mu),phen_space&#39;) for so in soptim]...)

mp = ModelParams(;p,
                tspan,
                u0,
                alg=Tsit5(),
                saveat = tsteps)
model = EcoEvoGraph(mp, g, phen_space, birth_fn, competition_fn)

sol = simulate(model)
fig, ax = plt.subplots(1)
ax.set_title(&quot;Trait-dependent competition&quot;)
ax.plot(model.phen_space, sol[end][1,:], color = &quot;tab:red&quot;, label = &quot;Node 1&quot;)
ax.plot(model.phen_space, sol[end][2,:], color = &quot;tab:blue&quot;, label = &quot;Node 2&quot;)
ax.set_xlabel(&quot;Phenotype&quot;)
ax.set_ylabel(&quot;Population number&quot;)
display(fig)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Boussange_et_al.jl#L18-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.EcosystemModelMcCann" href="#EcoEvoModelZoo.EcosystemModelMcCann"><code>EcoEvoModelZoo.EcosystemModelMcCann</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EcosystemModelMcKann</code></pre><p>This model is inspired from <a href="http://doi.wiley.com/10.2307/1939558">McCann 1994</a>.  Similar to EcosystemModelOmnivory, but without monivory.</p><p><strong>Model parameters</strong></p><ul><li><code>x_c, x_p</code>: mass-specific metabolic rate of consumers and predators</li><li><code>y_c, y_p</code>: ingestion rate per unit metabolic rate of consumers and predators.</li><li><code>R_0, C_0</code>: half saturation densities for the type II functional responses of the consumers and predators</li></ul><p><strong>Example</strong></p><p>```julia alg = BS3() abstol = 1e-6 reltol = 1e-6 tspan = (0., 800) tsteps = 550:4:800 p<em>true = (x</em>c = [0.4],          x<em>p = [0.08],          y</em>c = [2.01],         y<em>p = [5.00],          R</em>0 = [0.16129],          C_0 = [0.5])</p><p>u0_true = [0.5,0.8,0.5]</p><p>model = EcosystemModelMcCann(ModelParams(;p = p<em>true,                                         tspan,                                         u0 = u0</em>true,                                         alg,                                         reltol,                                         abstol,                                         saveat = tsteps,                                         verbose = false, # suppresses warnings for maxiters                                         maxiters = 50<em>000,                                         )) sol = simulate(model, u0 = u0</em>true)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/McCann_et_al.jl#L64-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.EcosystemModelOmnivory" href="#EcoEvoModelZoo.EcosystemModelOmnivory"><code>EcoEvoModelZoo.EcosystemModelOmnivory</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EcosystemModelOmnivory</code></pre><p>This model is inspired from <a href="10.1098/rspb.1997.0172">McCann 1997</a>.</p><p><strong>Model parameters</strong></p><ul><li><code>x_c, x_p</code>: mass-specific metabolic rate of consumers and predators</li><li><code>y_c, y_pr, y_pc</code>: ingestion rate per unit metabolic rate of consumers and predators.</li><li><code>R_0, R_02, C_0</code> half saturation densities for the type II functional responses of the consumers and predators</li><li><code>ω</code>: omnivory strength</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">alg = BS3()
abstol = 1e-6
reltol = 1e-6
tspan = (0., 800)
tsteps = 550:4:800

p_true = (x_c = [0.4], 
        x_p = [0.08], 
        y_c = [2.01], 
        y_pr = [2.00], 
        y_pc = [5.0], 
        R_0 = [0.16129], 
        R_02 = [ 0.5], 
        C_0 = [0.5],
        ω =[ 0.4])

u0_true = [0.5,0.8,0.5]


model = EcosystemModelOmnivory(ModelParams(;p = p_true,
                                        tspan,
                                        u0 = u0_true,
                                        alg,
                                        reltol,
                                        abstol,
                                        saveat = tsteps,
                                        verbose = false, # suppresses warnings for maxiters
                                        maxiters = 50_000,
                                        ))
sol = simulate(model, u0 = u0_true)</code></pre><p>```</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/McCann_et_al.jl#L5-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.Landscape" href="#EcoEvoModelZoo.Landscape"><code>EcoEvoModelZoo.Landscape</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Returns landscape parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/utils.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.ResourceCompetition" href="#EcoEvoModelZoo.ResourceCompetition"><code>EcoEvoModelZoo.ResourceCompetition</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The <code>ResourceCompetition</code> model is a type of ecological model that simulates competition for resources between different species of plankton. This model is inspired by Huisman et al. 1999 Nature.</p><p><strong>Arguments</strong></p><ul><li><code>mp</code> is a <code>ModelParams</code> object that contains information about the time span, the algorithm to use for numerical integration, and the tolerances to use.</li><li><code>nN</code> is the number of plankton species.</li><li><code>nR</code> is the number of resources.</li><li><code>S</code> is a vector of length nR containing the supply rates of each resource.</li><li><code>mu</code>: function for the ResourceCompetition model is set to the default function:</li></ul><pre><code class="language-julia hljs">μ(R, r, K) = r .* R ./ (K .+ R)</code></pre><p>where:</p><ul><li><code>R</code> is a vector of length nR containing the current concentration of each resource.</li><li><code>r</code> is a vector of length nN containing the maximum uptake rate of each plankton species.</li><li><code>K</code> is a vector of length nN containing the half-saturation constant of each plankton species.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Huisman_et_al.jl#L9-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.ResourceCompetitionSmoothMin" href="#EcoEvoModelZoo.ResourceCompetitionSmoothMin"><code>EcoEvoModelZoo.ResourceCompetitionSmoothMin</code></a> — <span class="docstring-category">Type</span></header><section><div><p>This model is inspired from <a href="http://www.nature.com/articles/46540">Huisman et al. 1999 Nature.</a>, but where Leibig&#39;s law is replaced by imperfect substituable resources (<a href="https://en.wikipedia.org/wiki/Smooth_maximum">smooth minimum</a>). The smooth min function is parametrized by s, which is a trainable parameter.</p><p><strong>Arguments</strong></p><ul><li><code>mp::MP</code>: ModelParams struct containing parameter values for the model.</li><li><code>nN::NN</code>: Number of plankton species in the model.</li><li><code>nR::NR</code>: Number of resource species in the model.</li><li><code>S::SS</code>: Supply rates.</li></ul><p><strong>Example</strong></p><pre><code class="nohighlight hljs">alg = BS3()
abstol = 1e-6
reltol = 1e-6
tspan = (0.,1000.)
step = 2.
nN = 5
nR = 5
r = ones(nN)
m = D = 0.25
S = [6., 10., 14., 4, 9]
K = [0.39 0.34 0.30 0.24 0.23;
    0.22 0.39 0.34 0.30 0.27;
    0.27 0.22 0.39 0.34 0.30;
    0.30 0.24 0.22 0.39 0.34;
    0.34 0.30 0.22 0.20 0.39]&#39;

C = [0.04 0.04 0.07 0.04 0.04;
    0.08 0.08 0.08 0.10 0.08;
    0.10 0.10 0.10 0.10 0.14;
    0.05 0.03 0.03 0.03 0.03;
    0.07 0.09 0.07 0.07 0.07]&#39;
s = -7.

p_true = (r = r, m = [m], D = [D], K = K, C = C, s = Float64[s])

N0 = [0.1 + i / 100 for i in 1:5]
R0 = S
u0 = [N0;R0]
tsteps = tspan[1]:step:tspan[2]

model = ResourceCompetitionSmoothMin(ModelParams(;p = p_true,
                                        tspan,
                                        u0,
                                        alg,
                                        reltol,
                                        abstol,
                                        saveat = tsteps
                                        ), 
                                        nN, nR, S)

# Species 1:5
sol = simulate(model, u0 = u0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Huisman_et_al.jl#L59-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.SimpleEcosystemModel" href="#EcoEvoModelZoo.SimpleEcosystemModel"><code>EcoEvoModelZoo.SimpleEcosystemModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>General multitrophic ecosystem model that models the population dynamics of multiple species in an ecosystem.</p><p><strong>Arguments</strong></p><ul><li><code>mp</code>: Model parameters of type ModelParams.</li><li><code>intinsic_growth_rate</code>: A function that takes in the model parameters <code>p</code> and time <code>t</code> and returns the intrinsic growth rate of the population.</li><li><code>carrying_capacity</code>: A function that takes in the model parameters <code>p</code> and time <code>t</code> and returns the carrying capacity of the population.</li><li><code>competition</code>: A function that takes in the state <code>u</code>, model parameters <code>p</code>, and time <code>t</code> and returns the effect of population density on the growth rate.</li><li><code>resource_conversion_efficiency</code>: A function that takes in the model parameters <code>p</code> and time <code>t</code> and returns the efficiency of converting resources into population growth.</li><li><code>feeding</code>: A function that takes in the state <code>u</code>, model parameters <code>p</code>, and time <code>t</code> and returns the feeding rates of the population.</li></ul><p><strong>Example 1</strong></p><p>Simulating a chaotic 5 compartment food web model proposed in <a href="https://www.jstor.org/stable/177129">Post et al. 2000</a>.</p><pre><code class="language-julia hljs">alg = BS3()
abstol = 1e-6
reltol = 1e-6
tspan = (0., 600)
tsteps = (tspan[1]):1.:(tspan[end])
N = 5 # number of compartment

x_c = 0.15, 
x_p = 0.08
y_c = 2.3
y_p = 1.7
R_0 = 0.25
C_0 = 0.5
ω = 0.2

# constructing simple chain foodweb
# Population vector is organised in such a way
# N = [R1, C1, P, R2, C2]
foodweb = SimpleWeightedDiGraph(N)
add_edge!(foodweb, 2, 1, 1.) # C1 to R1
add_edge!(foodweb, 5, 4, 1.) # C2 to R2
add_edge!(foodweb, 3, 2, ω) # P to C1
add_edge!(foodweb, 3, 5, 1-ω) # P to C2

H = sparse(zeros(N,N))
H[2,1] = 1 / (x_c * y_c); H[5,4] = 1 / (x_c * y_c); 
H[3,2] = 1 / (x_p * y_p); H[3,5] = 1 / (x_p * y_p)

q = sparse(zeros(N,N))
q[2,1] = x_c * y_c / R_0; q[5,4] = x_c * y_c / R_0;
q[3,2] = x_p * y_p / C_0; q[3,5] = x_p * y_p / C_0

p = (r = vcat(1., -x_c, -x_p, 1., -x_c,), 
        K = ones(N), 
        A = diagm(vcat(1,0,0,1,0)), 
        ϵ = ones(N), 
        q = q,
        H = H, 
        W = adjacency_matrix(foodweb))

u0_true = rand(N)


model = SimpleEcosystemModel(;mp = ModelParams(;p,
                                        tspan,
                                        u0 = u0_true,
                                        alg,
                                        reltol,
                                        abstol,
                                        saveat = tsteps,
                                        verbose = false, # suppresses warnings for maxiters
                                        maxiters = 50_000,
                                        ))
sol = simulate(model)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/simple_ecosystem_model.jl#L1-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.Temperature" href="#EcoEvoModelZoo.Temperature"><code>EcoEvoModelZoo.Temperature</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Temperature as a function of space (x), time (t), and some climate parameters</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/utils.jl#L106-L110">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.funcresp!-Tuple{Any, Any, Any, Trophic{true}}" href="#EcoEvoModelZoo.funcresp!-Tuple{Any, Any, Any, Trophic{true}}"><code>EcoEvoModelZoo.funcresp!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">funcresp!(F, n, p, _)
</code></pre><p>Type II functional response Input:</p><ul><li>n: Vector of population densities of all species in a given patch</li><li>Th: Vector of handling times (with dummy values for resource species)</li><li>arate: Vector of attack rates (with dummy values for resource species)</li><li>W: Adjacency matrix of trophic network; W(i,j)=1 if i eats j and 0 otherwise</li></ul><p>Output:</p><ul><li>A matrix F(i,j), the feeding rate of consumer i on resource j</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/utils.jl#L125-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.generate_network-Tuple{Int64, Int64}" href="#EcoEvoModelZoo.generate_network-Tuple{Int64, Int64}"><code>EcoEvoModelZoo.generate_network</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_network(SR::Int, SC::Int)</code></pre><p>return matrix W[i,j], which is nonzero if consumer i eats resource j SR is the number of resource, SC the number of consumer species.</p><p>The bipartite network is generated as follows.  First, both resources and consumers are labeled consecutively,  based on their initial temperature adaptations:  resource 1 / consumer 1 are the most cold-adapted,  and resource S / consumer S the most warm-adapted.  Next, we always put a feeding link between consumer i and resource i.  Finally, each consumer is randomly linked to four other resource species.  This yields a feeding network where every consumer is  connected to five resources altogether.</p><p>Note: it seems that the definition of W_ij is that it determines which resource i is eat by consumer j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/utils.jl#L11-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.init_akesson_model-Union{Tuple{}, Tuple{Tr}} where Tr" href="#EcoEvoModelZoo.init_akesson_model-Union{Tuple{}, Tuple{Tr}} where Tr"><code>EcoEvoModelZoo.init_akesson_model</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_akesson_model(
;
    mp,
    land,
    temp,
    width_growth,
    competition,
    trophic,
    SR,
    SC,
    kwargs...
)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>width_growth::WidthGrowth</code>: an instance of the WidthGrowth struct representing the width growth function.</li><li><code>competition::Competition</code>: an instance of the Competition struct representing the competition function.</li><li><code>trophic::Tr</code>: an instance of the Trophic struct representing the trophic interaction. Defaults to Trophic{false}() representing a single trophic level.</li><li><code>SR::Int</code>: the number of species in each patch. Defaults to 50.</li><li><code>SC::Int</code>: the number of patches. Defaults to 0 (only one patch).</li><li><code>kwargs</code>: additional keyword arguments to pass to the Base.ODEProblem constructor.</li></ul><p><strong>Example</strong></p><p>Here we simulate Akesson model in the most simple version with one trophic level, one patch, and where competition is temperature dependent. The code starts by setting the simulation time frame, choosing a differential equation solver algorithm, and defining the tolerance levels for the solver. The model is then initialized with various parameters, including the landscape size, carrying capacity, and temperature dependency of competition. The temperature over a period of 6500 years is plotted using matplotlib. The model is then simulated before and after climate change, with the population density and population mean trait (optimal temperature) plotted for each time step.</p><pre><code class="language-julia hljs">using EcoEvoModelZoo
using PythonCall
using OrdinaryDiffEq
using ParametricModels
plt = pyimport(&quot;matplotlib.pyplot&quot;)

tstart = -4000 # starting time (relative to start of climate change at t = 0)
tend = 2500 # time at which integration ends
alg = Tsit5()
abstol = 1e-6
reltol = 1e-6
# integrate prob with Julia
tspan = (tstart, 0)
tsteps = tspan[1]:200:tspan[2]
L = 10
SR = 50
temp = Temperature()
land = Landscape(L)

model = init_akesson_model(;mp = ModelParams(;tspan, alg, reltol, abstol, saveat = tsteps),
                            land = Landscape(L),
                            temp,
                            SR = SR,
                            width_growth = WidthGrowth{:TraitDep}(), 
                            competition = Competition{:TraitDep}(), 
                            trophic= Trophic{false}(), 
                            )

# Plotting temperature over 6500 years, from -4000 to 2500
fig, ax = plt.subplots(1)
ts = -100:1:400
p = get_p(model)
temp_ts = [temp.(land.x, t)[1] for t in ts]
ax.plot(ts, temp_ts)
display(fig)

#################
### BEFORE Climate Change ###
#################
sol = simulate(model)
ode_data = Array(sol)

# initial temperature
temp.(land.x, 100.)

# plotting evolution before CC
fig, ax = plt.subplots(1)
l = 1 # patch index
plotting_N_through_time(ax, ode_data, tsteps, l, model)
# ax.set_yscale(&quot;log&quot;)
display(fig)


#################
### After Climate Change  ###
#################
tspan = (0, 300)
step = 1
tsteps = tspan[1]:1.:tspan[2]
sol = simulate(model, tspan = tspan, saveat = tsteps, u0 = ode_data[:,:,end])
ode_data = Array(sol)

# plotting evolution after CC
fig, axs = plt.subplots(1, 2)
ts = 1:length(tsteps)
l = 1 # patch index
plotting_N_through_time(axs[0], ode_data, tsteps, l, model)
axs[0].set_ylabel(&quot;Population density&quot;)
# axs[0].set_yscale(&quot;log&quot;)
plotting_mu_through_time(axs[1], ode_data, tsteps, l, model)
axs[1].set_ylabel(&quot;Population mean trait
(Optimal temperature)&quot;)
fig.tight_layout()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/model.jl#L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EcoEvoModelZoo.smoothstep-Tuple{Any}" href="#EcoEvoModelZoo.smoothstep-Tuple{Any}"><code>EcoEvoModelZoo.smoothstep</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Apply twice continuously differentiable smoothed step function to a number x Input: x: Distance from pole, measured in units of the pole-to-equator distance Output: 0 if x &lt; 0; 10<em>x^3-15</em>x^4+6*x^5 if 0 &lt;= x &lt;= 1; otherwise 1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/vboussange/EcoEvoModelZoo.jl/blob/d9491de450d0911e060f7a306cd21e6906ed39b7/src/Akesson_et_al/utils.jl#L89-L93">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Friday 3 March 2023 16:16">Friday 3 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
